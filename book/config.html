<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Config - cargo-dist</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="install.html"><strong aria-hidden="true">2.</strong> Install</a></li><li class="chapter-item expanded "><a href="way-too-quickstart.html"><strong aria-hidden="true">3.</strong> Way Too Quick Start</a></li><li class="chapter-item expanded "><a href="guide.html"><strong aria-hidden="true">4.</strong> Guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="simple-guide.html"><strong aria-hidden="true">4.1.</strong> A Simple Application</a></li><li class="chapter-item expanded "><a href="workspace-guide.html"><strong aria-hidden="true">4.2.</strong> More Complex Workspaces</a></li><li class="chapter-item expanded "><a href="cargo-release-guide.html"><strong aria-hidden="true">4.3.</strong> Using cargo-release</a></li></ol></li><li class="chapter-item expanded "><a href="reference.html"><strong aria-hidden="true">5.</strong> Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="concepts.html"><strong aria-hidden="true">5.1.</strong> Concepts</a></li><li class="chapter-item expanded "><a href="config.html" class="active"><strong aria-hidden="true">5.2.</strong> Config</a></li><li class="chapter-item expanded "><a href="artifacts.html"><strong aria-hidden="true">5.3.</strong> Artifacts</a></li><li class="chapter-item expanded "><a href="installers.html"><strong aria-hidden="true">5.4.</strong> Installers</a></li><li class="chapter-item expanded "><a href="cli.html"><strong aria-hidden="true">5.5.</strong> CLI Manual</a></li><li class="chapter-item expanded "><a href="schema.html"><strong aria-hidden="true">5.6.</strong> dist-manifest.json</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">cargo-dist</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/axodotdev/cargo-dist" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/axodotdev/cargo-dist/edit/main/book/src/config.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>


                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="config"><a class="header" href="#config">Config</a></h1>
<ul>
<li><a href="#relevant-cargotoml-fields">Relevant Cargo.toml Fields</a>
<ul>
<li><a href="#name">name</a></li>
<li><a href="#version">version</a></li>
<li><a href="#publish">publish</a></li>
<li><a href="#repository">repository</a></li>
<li><a href="#readme">readme</a></li>
<li><a href="#license-file">license-file</a></li>
</ul>
</li>
<li><a href="#metadatadist">metadata.dist</a>
<ul>
<li><a href="#cargo-dist-version">cargo-dist-version</a></li>
<li><a href="#rust-toolchain-version">rust-toolchain-version</a></li>
<li><a href="#ci">ci</a></li>
<li><a href="#targets">targets</a></li>
<li><a href="#installers">installers</a></li>
<li><a href="#include">include</a></li>
<li><a href="#auto-includes">auto-includes</a></li>
<li><a href="#windows-archive">windows-archive</a></li>
<li><a href="#unix-archive">unix-archive</a></li>
<li><a href="#dist">dist</a></li>
<li><a href="#npm-scope">npm-scope</a></li>
<li><a href="#checksum">checksum</a></li>
</ul>
</li>
<li><a href="#subsetting-ci-flags">Subsetting CI Flags</a></li>
</ul>
<p>cargo-dist accepts configuration from the following sources, in order of increasing preference (that is, CLI flags generally replace things specified in your Cargo.toml):</p>
<ul>
<li>Relevant <a href="https://doc.rust-lang.org/cargo/reference/manifest.html">Cargo.toml fields</a> like &quot;repository&quot; and &quot;readme&quot;</li>
<li><code>[workspace.metadata.dist]</code></li>
<li><code>[package.metadata.dist]</code></li>
<li>CLI flags</li>
</ul>
<p>As discussed in <a href="./concepts.html">concepts</a>, all of your config should be persistently stored in the first 3 locations so that every run of cargo-dist agrees on what &quot;build everything&quot; should look like. CLI flags should primarily be used to select <em>subsets</em> of that &quot;everything&quot; for an individual run of cargo-dist to care about.</p>
<h2 id="relevant-cargotoml-fields"><a class="header" href="#relevant-cargotoml-fields">Relevant Cargo.toml Fields</a></h2>
<p>The <a href="https://doc.rust-lang.org/cargo/reference/manifest.html">builtin Cargo.toml fields</a> define a lot of things that cargo-dist cares about. Here's the ones that matter:</p>
<h3 id="name"><a class="header" href="#name">name</a></h3>
<p>The name of your package will become the name cargo-dist uses to refer to your package. There is currently no notion of a &quot;prettier display name&quot; (if you have a use for that, let us know!).</p>
<h3 id="version"><a class="header" href="#version">version</a></h3>
<p>The version of your package is used pervasively, and cargo-dist will generally error out if you ask it to build &quot;my-app-1.0.0&quot; when the actual &quot;my-app&quot; package is set to version &quot;1.1.0&quot;.</p>
<h3 id="publish"><a class="header" href="#publish">publish</a></h3>
<p>If you set <code>publish = false</code> in your Cargo.toml we will treat this as a hint that cargo-dist should ignore all the affected packages completely. You can override this with dist's own <code>dist = true</code> config.</p>
<h3 id="repository"><a class="header" href="#repository">repository</a></h3>
<p>cargo-dist has an internal notion of an &quot;artifact download URL&quot; that is required for things like <a href="./installers.html">installers</a> that detect the current platform and fetch binaries. If your CI backend is &quot;github&quot; then we will base the &quot;<a href="./installers.html#artifact-download-url">artifact download URL</a>&quot; on the &quot;repository&quot; key. To be safe, we will only do this if your workspace agrees on this value. It's fine if only some packages bother setting &quot;repository&quot;, as long as the ones that do use the exact same string. If they don't we will fail to compute an &quot;artifact download URL&quot;, emit a warning, and ignore your request for installers that require it. (This might want to be a hard error in the future.)</p>
<h3 id="readme"><a class="header" href="#readme">readme</a></h3>
<p>cargo-dist defaults to trying to include certain &quot;important&quot; static files in your executable-zips. A README is one of them.</p>
<p>If you specify a path to a README file, cargo-dist will use that for all the packages it affects. If you don't, then cargo-dist will search for a README* file in the package's root directory and the workspace's root directory (preferring the package).</p>
<h3 id="license-file"><a class="header" href="#license-file">license-file</a></h3>
<p>cargo-dist defaults to trying to include certain &quot;important&quot; static files in your executable-zips. A LICENSE is one of them.</p>
<p>If you specify a path to a license file, cargo-dist will use that for all packages it affects. Otherwise, cargo-dist will search for LICENSE* or UNLICENSE* files in the package's root directory and the workspace's root directory (preferring the package). If multiple are defined in the same directory, we will grab them all (this is necessary for the extremely common dual MIT/Apache license, which often results in two LICENSE-* files). </p>
<p>Note that the Cargo license-file flag only accepts one path, so it can't handle the dual-license-file case. This cargo feature largely exists as an escape hatch for weird licenses which can't be described by the SPDX format of the &quot;license&quot; field.</p>
<h2 id="metadatadist"><a class="header" href="#metadatadist">metadata.dist</a></h2>
<p>Cargo allows other tools to include their own project-wide settings in <a href="https://doc.rust-lang.org/cargo/reference/workspaces.html#the-metadata-table">metadata tables</a>. The one cargo-dist uses is <code>[workspace.metadata.dist]</code>, which must appear in your root Cargo.toml (whether or not it's <a href="https://doc.rust-lang.org/cargo/reference/workspaces.html">virtual</a>). All settings specified here apply to all packages in your project. You can override them on a per-package basis with <code>[package.metadata.dist]</code>, which accepts all the same fields (except for those which must be specified once globally, see the docs for each individual option).</p>
<h3 id="cargo-dist-version"><a class="header" href="#cargo-dist-version">cargo-dist-version</a></h3>
<blockquote>
<p>since 0.0.3</p>
</blockquote>
<p>Example: <code>cargo-dist-version = &quot;0.0.3&quot;</code> </p>
<p><strong>This can only be set globally</strong></p>
<p>This is added automatically by <code>cargo dist init</code>, and is a recording of its own version for the sake of reproducibility and documentation. When you run <a href="./cli.html#cargo-dist-generate-ci">generate-ci</a> the resulting CI scripts will use that version of cargo-dist to build your applications.</p>
<p>The syntax must be a valid <a href="https://docs.rs/semver/latest/semver/struct.Version.html">Cargo-style SemVer Version</a> (not a VersionReq!).</p>
<p>If you delete the key, generate-ci will just use the version of cargo-dist that's currently running.</p>
<h3 id="rust-toolchain-version"><a class="header" href="#rust-toolchain-version">rust-toolchain-version</a></h3>
<blockquote>
<p>since 0.0.3</p>
</blockquote>
<p>Example: <code>rust-toolchain-version = &quot;1.67.1&quot;</code> </p>
<p><strong>This can only be set globally</strong></p>
<p>This is added automatically by <code>cargo dist init</code>, recorded for the sake of reproducibility and documentation. It represents the &quot;ideal&quot; Rust toolchain to build your project with. This is in contrast to the builtin Cargo <a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-rust-version-field">rust-version</a> which is used to specify the <em>minimum</em> supported Rust version. When you run <a href="./cli.html#cargo-dist-generate-ci">generate-ci</a> the resulting CI scripts will install that version of the Rust toolchain with <a href="https://rust-lang.github.io/rustup/">rustup</a>. There's nothing special about the chosen value, it's just a hardcoded &quot;recent stable version&quot;.</p>
<p>The syntax must be a valid rustup toolchain like &quot;1.60.0&quot; or &quot;stable&quot; (should not specify the platform, we want to install this toolchain on all platforms).</p>
<p>If you delete the key, generate-ci will just use &quot;stable&quot; which will drift over time as new stable releases occur.</p>
<h3 id="ci"><a class="header" href="#ci">ci</a></h3>
<blockquote>
<p>since 0.0.3</p>
</blockquote>
<p>Example: <code>ci = [&quot;github&quot;]</code></p>
<p><strong>This can only be set globally</strong></p>
<p>This is a list of CI backends you want to support, allowing subsequent runs of <a href="./cli.html#cargo-dist-generate-ci">generate-ci</a> to know what CI scripts to generate. Its presence also enables certain CI-specific features. For instance if &quot;github&quot; is included we'll try to generate the body for a Github Release and tell <a href="./installers.html">installers</a> to fetch binaries from a Github Release.  Once we introduce more CI backends we'll need to more completely rationalize what that means. In all likelihood each set of CI scripts will need to explicitly select just its own CI by passing <code>--ci=...</code> for every invocation.</p>
<p>&quot;github&quot; is currently the only supported CI backend.</p>
<p><code>cargo dist init</code> can set this if you pass <code>--ci=...</code></p>
<h3 id="targets"><a class="header" href="#targets">targets</a></h3>
<blockquote>
<p>since 0.0.3</p>
</blockquote>
<p>Example: <code>targets = [&quot;x86_64-unknown-linux-gnu&quot;, &quot;x86_64-apple-darwin&quot;, &quot;x86_64-pc-windows-msvc&quot;]</code></p>
<p>This is a list of <a href="https://doc.rust-lang.org/nightly/rustc/platform-support.html">target platforms</a> you want your application(s) to be built for. In principle this can be overridden on a per-package basis but that is not well tested.</p>
<p>In v0.0.5 the only properly supported choices are:</p>
<ul>
<li>x64 macOS: &quot;x86_64-apple-darwin&quot;</li>
<li>x64 Windows: &quot;x86_64-pc-windows-msvc&quot;</li>
<li>x64 Linux: &quot;x86_64-unknown-linux-gnu&quot;</li>
<li>arm64 macOS (Apple silicon): &quot;aarch64-apple-darwin&quot; (supported added in v0.0.4)</li>
</ul>
<p>Future versions should hopefully introduce proper support for important targets like &quot;musl linux&quot;.</p>
<p>By default all runs of <code>cargo-dist</code> will be trying to handle all platforms specified here at once. If you specify <code>--target=...</code> on the CLI this will focus the run to only those platforms. As discussed in <a href="./concepts.html">concepts</a>, this cannot be used to specify platforms that are not listed in <code>metadata.dist</code>, to ensure different runs agree on the maximum set of platforms.</p>
<h3 id="installers"><a class="header" href="#installers">installers</a></h3>
<blockquote>
<p>since 0.0.3</p>
</blockquote>
<p>Example: <code>installers = [&quot;shell&quot;, &quot;powershell&quot;]</code></p>
<p>This is a list of installers you want to be made for your application(s). In principle this can be overridden on a per-package basis but that is not well tested. See <a href="./installers.html">the full docs on installers for the full list of values</a>.</p>
<p>See &quot;repository&quot; for some discussion on the &quot;Artifact Download URL&quot;.</p>
<h3 id="include"><a class="header" href="#include">include</a></h3>
<blockquote>
<p>since 0.0.3</p>
</blockquote>
<p>Example: <code>include = [&quot;my-cool-file.txt&quot;, &quot;../other-cool-file.txt&quot;]</code></p>
<p>This is a list of additional <em>files</em> (directory support TBD) to copy into the root of all <a href="./artifacts.html#executable-zip">executable-zips</a> that this setting affects. The paths are relative to the directory of the Cargo.toml that you placed this setting in. Globs are not supported.</p>
<h3 id="auto-includes"><a class="header" href="#auto-includes">auto-includes</a></h3>
<blockquote>
<p>since 0.0.3</p>
</blockquote>
<p>Example: <code>auto-includes = false</code></p>
<p>Allows you to specify whether cargo-dist should auto-include README, (UN)LICENSE, and CHANGELOG/RELEASES files in <a href="./artifacts.html#executable-zip">executable-zips</a>. Defaults to true.</p>
<h3 id="windows-archive"><a class="header" href="#windows-archive">windows-archive</a></h3>
<blockquote>
<p>since 0.0.5</p>
</blockquote>
<p>Example: <code>windows-archive = &quot;.tar.gz&quot;</code></p>
<p>Allows you to specify the file format to use for <a href="./artifacts.html#executable-zip">executable-zips</a> that target windows. The default is
&quot;.zip&quot;. Supported values:</p>
<ul>
<li>&quot;.zip&quot;</li>
<li>&quot;.tar.gz&quot;</li>
<li>&quot;.tar.xz&quot;</li>
<li>&quot;.tar.zstd&quot;</li>
</ul>
<p>See also unix-archive below.</p>
<h3 id="unix-archive"><a class="header" href="#unix-archive">unix-archive</a></h3>
<blockquote>
<p>since 0.0.5</p>
</blockquote>
<p>Example: <code>unix-archive = &quot;.tar.gz&quot;</code></p>
<p>Allows you to specify the file format to use for <a href="./artifacts.html#executable-zip">executable-zips</a> that target not-windows. The default is
&quot;.tar.xz&quot;. See &quot;windows-archive&quot; above for a complete list of supported values.</p>
<h3 id="dist"><a class="header" href="#dist">dist</a></h3>
<blockquote>
<p>since 0.0.3</p>
</blockquote>
<p>Example: <code>dist = false</code></p>
<p>Specifies whether cargo-dist should ignore this package. It primarily exists as an alternative for <code>publish=false</code> or an override for <code>publish=false</code>.</p>
<h3 id="npm-scope"><a class="header" href="#npm-scope">npm-scope</a></h3>
<blockquote>
<p>since 0.0.6</p>
</blockquote>
<p>Example <code>npm-scope = &quot;@axodotdev&quot;</code></p>
<p>Specifies that <a href="./installers.html#npm">npm installers</a> should be published under the given <a href="https://docs.npmjs.com/cli/v9/using-npm/scope">scope</a>. The leading <code>@</code> is mandatory. If you newly enable the npm installer in <code>cargo dist init</code>'s interactive UI, then it will give you an opportunity to add the scope.</p>
<p>If no scope is specified the package will be global.</p>
<h3 id="checksum"><a class="header" href="#checksum">checksum</a></h3>
<blockquote>
<p>since 0.1.0</p>
</blockquote>
<p>Example <code>checksum = &quot;sha512&quot;</code></p>
<p>Specifies how to checksum <a href="./artifacts.html#executable-zip">executable-zips</a>. Supported values:</p>
<ul>
<li>&quot;sha256&quot; (default) - generate a .sha256 file for each archive</li>
<li>&quot;sha512&quot; - generate a .sha512 file for each archive</li>
<li>&quot;false&quot; - do not generate any checksums</li>
</ul>
<p>The hashes should match the result that sha256sum and sha512sum generate. The current format is just a file containing the hash of that file and nothing else.</p>
<p>Future work is planned to <a href="https://github.com/axodotdev/cargo-dist/issues/120">support more robust signed checksums</a>.</p>
<h2 id="subsetting-ci-flags"><a class="header" href="#subsetting-ci-flags">Subsetting CI Flags</a></h2>
<p>Several <code>metadata.dist</code> configs have globally available CLI equivalents. These can be used to select a subset of <code>metadata.dist</code> list for that run. If you don't pass any, it will be as-if you passed all the values in <code>metadata.dist</code>. You can pass these flags multiple times to provide a list. This includes:</p>
<ul>
<li><code>--target</code></li>
<li><code>--installer</code></li>
<li><code>--ci</code></li>
</ul>
<p>See <a href="./concepts.html#artifact-modes-selecting-artifacts">Artifact Modes</a> for how you might use this kind of subsetting.</p>
<p>Caveat: the default &quot;host&quot; Artifact Mode does something fuzzier with <code>--target</code> to allow you to build binaries that are usable on the current platform. Again see <a href="./concepts.html#artifact-modes-selecting-artifacts">Artifact Modes</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="concepts.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="artifacts.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="concepts.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="artifacts.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>



        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
